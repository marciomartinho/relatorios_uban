{% extends "base_relatorio.html" %}

{% block titulo %}Balanço Orçamentário da Receita{% endblock %}

{% block titulo_relatorio %}BALANÇO ORÇAMENTÁRIO DA RECEITA{% endblock %}

{% block conteudo %}
<table>
    <thead>
        <tr>
            <th rowspan="2">RECEITAS</th>
            <th>PREVISÃO INICIAL</th>
            <th>PREVISÃO ATUALIZADA</th>
            <th>RECEITA REALIZADA</th>
            <th>RECEITA REALIZADA</th>
            <th>VARIAÇÃO</th>
        </tr>
        <tr>
            <th>2025</th>
            <th>2025</th>
            <th>{{ mes_ref }}/2025</th>
            <th>{{ mes_ref }}/2024</th>
            <th>2025 x 2024</th>
        </tr>
    </thead>
    <tbody>
        {% for linha in dados_relatorio %}
            <tr class="{{ linha.tipo }}">
                <td>{{ linha.especificacao }}</td>
                <td>{{ linha.pi_2025_fmt }}</td>
                <td>{{ linha.pa_2025_fmt }}</td>
                <td>{{ linha.rr_2025_fmt }}</td>
                <td>{{ linha.rr_2024_fmt }}</td>
                <td class="{% if linha.saldo < 0 %}valor-negativo{% endif %}">
                    {{ linha.saldo_fmt }}
                </td>
            </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}

{% block scripts %}
<script>
    // Dados para o PDF
    const dadosPDF = {{ dados_pdf | tojson | safe }};
    const tiposLinhas = {{ dados_relatorio | map(attribute='tipo') | list | tojson | safe }};
    
    // Configurar botão de PDF
    document.getElementById('btn-pdf').addEventListener('click', () => {
        RelatorioUtils.gerarPDF({
            titulo: 'Balanço Orçamentário da Receita',
            subtitulo: 'Exercício 2025 - {{ mes_ref }}/2025',
            dados: dadosPDF,
            nomeArquivo: 'balanco-orcamentario-receita.pdf',
            colunasTipos: tiposLinhas
        });
    });
</script>
{% endblock %}